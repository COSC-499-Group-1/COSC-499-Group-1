<div *ngIf="userProfile" class="wrapper">
    <mat-card>
        <div class="icon">
            <mat-card-header>
                <div (mouseenter)="imageHover = !imageHover" (mouseleave)="imageHover = !imageHover">
                    <img
                        alt="assets/icon-alt.PNG"
                        class="profilePicture"
                        id="profileImage"
                        onerror="this.onerror=null; this.src='assets/icon-alt.PNG'"
                        src="{{ this.userProfile.profileImage }}"
                    />
                    <form (ngSubmit)="imageFormSubmit()" [formGroup]="imageForm">
                        <input
                            #fileInput
                            (change)="imageFormButtonClick($event)"
                            accept=".png,.jpg,.jpeg"
                            id="imageInput"
                            name="profileImage"
                            type="file"
                        />
                        <input formControlName="profileImageName" name="imageName" type="hidden"/>
                        <input formControlName="profileImageSize" name="imageSize" type="hidden"/>
                        <mat-error
                            *ngFor="let validation of common.validation_methods.profileImageName"
                            class="profileError"
                        >
                            <mat-error
                                *ngIf="
                                    formValidationService.checkIfFormElementInvalid(
                                        imageForm,
                                        'profileImageName',
                                        validation,
                                        true
                                    )
                                "
                            >
                                {{ validation.message }}
                            </mat-error>
                        </mat-error>
                        <mat-error
                            *ngFor="let validation of common.validation_methods.profileImageSize"
                            class="profileError"
                        >
                            <mat-error
                                *ngIf="
                                    formValidationService.checkIfFormElementInvalid(
                                        imageForm,
                                        'profileImageSize',
                                        validation,
                                        true
                                    )
                                "
                            >
                                {{ validation.message }}
                            </mat-error>
                        </mat-error>
                        <button id="hiddenButton" style="display:none;" type="submit"></button>
                    </form>
                    <button
                        (click)="fileInput.click()"
                        *ngIf="
                            this.userProfile.username === this.auth.getAuthenticatedUser().getUsername() && imageHover
                        "
                        id="imageButton"
                        mat-button
                    >
                        Select File
                    </button>
                </div>
                <b id="profileTitle">{{ userProfile.username }}'s Profile</b>
            </mat-card-header>
        </div>
        <mat-card-content>
            <hr/>
            <br/>
            <p>
                <i>{{ editSaveMessage }}</i>
            </p>
            <div *ngIf="userProfile && !editing" class="profileInfo">
                <p class="nameHeaders">
                    <b>Status</b
                    ><span
                    (click)="this.toggleEditingStatus(true)"
                    *ngIf="this.userProfile.username === this.auth.getAuthenticatedUser().getUsername()"
                >
                        Click to update</span
                >
                </p>
                <p (click)="this.toggleEditingStatus(true)" *ngIf="!editingStatus">{{ userProfile.statusText }}</p>
                <form
                    (ngSubmit)="statusFormSubmit(statusForm)"
                    *ngIf="
                        this.userProfile.username === this.auth.getAuthenticatedUser().getUsername() && editingStatus
                    "
                    [formGroup]="statusForm"
                >
                    <label>
                        <input
                            autocomplete="off"
                            formControlName="statusText"
                            maxlength="25"
                            name="statusText"
                            type="text"
                        />
                    </label>
                    <button mat-button type="submit">Update</button>
                </form>
                <p class="nameHeaders"><b>Username</b></p>
                <p>{{ userProfile.username }}</p>
                <hr/>
                <div *ngIf="userProfile.email">
                    <p class="nameHeaders"><b>Email</b></p>
                    <p>{{ userProfile.email }}</p>
                    <hr/>
                </div>
                <p class="nameHeaders"><b>First Name</b></p>
                <p>{{ userProfile.firstName }}</p>
                <hr/>
                <p class="nameHeaders"><b>Last Name</b></p>
                <p>{{ userProfile.lastName }}</p>
                <hr/>
            </div>
            <div
                *ngIf="
                    userProfile &&
                    editing &&
                    this.userProfile.username === this.auth.getAuthenticatedUser().getUsername()
                "
                class="profileInfo"
            >
                <p class="nameHeaders"><b>Username</b></p>
                <p>{{ userProfile.username }}</p>
                <hr/>
                <form (ngSubmit)="editFormSubmit(editForm)" [formGroup]="editForm">
                    <p class="nameHeaders"><b>Email</b></p>
                    <label for="email"></label><input autocomplete="off" formControlName="email" id="email" name="email"
                                                      required type="email"/>
                    <mat-error *ngFor="let validation of common.validation_methods.email">
                        <mat-error
                            *ngIf="
                                formValidationService.checkIfFormElementInvalid(
                                    editForm,
                                    'email',
                                    validation,
                                    submitAttempt
                                )
                            "
                        >
                            {{ validation.message }}
                        </mat-error>
                    </mat-error>
                    <hr/>
                    <p class="nameHeaders"><b>First Name</b></p>
                    <label for="firstName"></label><input
                    autocomplete="off"
                    formControlName="firstName"
                    id="firstName"
                    name="firstName"
                    required
                    type="text"
                />
                    <mat-error *ngFor="let validation of common.validation_methods.firstName">
                        <mat-error
                            *ngIf="
                                formValidationService.checkIfFormElementInvalid(
                                    editForm,
                                    'firstName',
                                    validation,
                                    submitAttempt
                                )
                            "
                        >
                            {{ validation.message }}
                        </mat-error>
                    </mat-error>
                    <hr/>
                    <p class="nameHeaders"><b>Last Name</b></p>
                    <label for="lastName"></label><input
                    autocomplete="off"
                    formControlName="lastName"
                    id="lastName"
                    name="lastName"
                    required
                    type="text"
                />
                    <mat-error *ngFor="let validation of common.validation_methods.lastName">
                        <mat-error
                            *ngIf="
                                formValidationService.checkIfFormElementInvalid(
                                    editForm,
                                    'lastName',
                                    validation,
                                    submitAttempt
                                )
                            "
                        >
                            {{ validation.message }}
                        </mat-error>
                    </mat-error>
                    <hr/>
                    <button *ngIf="editing" mat-button type="submit">
                        Save
                    </button>
                </form>
            </div>
            <button
                (click)="toggleEditing(true)"
                *ngIf="this.userProfile.username === this.auth.getAuthenticatedUser().getUsername() && !editing"
                mat-button
            >
                Edit
            </button>
        </mat-card-content>
    </mat-card>
</div>
